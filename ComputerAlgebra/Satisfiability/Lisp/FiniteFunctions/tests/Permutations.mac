/* Matthew Gwynne, 15.12.2009 (Swansea) */
/* Copyright 2009 Oliver Kullmann
This file is part of the OKlibrary. OKlibrary is free software; you can redistribute
it and/or modify it under the terms of the GNU General Public License as published by
the Free Software Foundation and included in this library; either version 3 of the
License, or any later version. */

/*!
\file ComputerAlgebra/Satisfiability/Lisp/FiniteFunctions/tests/Permutations.mac
  \brief Tests for the analysis functions of permutations as boolean functions

Use by

oklib_load("OKlib/ComputerAlgebra/Satisfiability/Lisp/FiniteFunctions/tests/Permutations.mac");

*/

/*!
\htmlonly
*/

okltest_perm_fulldnf_fcs(f) := block(
  assert(f([]) = [{},{}]),
  assert(f([0]) = [{1,2}, {{-2,-1}}]),
  assert(f([1]) = [{1,2}, {{1,2}}]),
  assert(f([15]) = [{1,2,3,4,5,6,7,8},{{1,2,3,4,5,6,7,8}}]),
  assert(f([16]) = [{1,2,3,4,5,6,7,8,9,10},{{-10,-9,-8,-7,-5,-4,-3,-2,1,6}}]),
  assert(f([0,1,2]) = [{1,2,3,4},{{-4,-3,-2,-1},{-4,-2,1,3},{-3,-1,2,4}}]),
  assert(f([2,1,0]) = [{1,2,3,4},{{-4,-2,-1,3},{-3,-1,2,4},{-4,-3,-2,1}}]),
  assert(f([1,0,2]) = [{1,2,3,4},{{-4,-3,-1,2},{-4,-2,1,3},{-3,-2,-1,4}}]),
  if oklib_test_level = 0 then return(true),
  for i : 2 thru 4 do 
    for j in permutations(create_list(k,k,1,i)) do
      assert(length(clauses_f(f(j))) = i),
  true)$

okltest_perm_fullcnf_fcs(f) := block(
  assert(f([]) = [{},{{}}]),
  assert(f([0]) = [{1,2},{{-2,-1},{-2,1},{-1,2}}]),
  assert(f([1]) = [{1,2},{{-2,1},{-1,2},{1,2}}]),
  assert(f([0,1,2]) = [{1,2,3,4}, {{-4,-3,-2,-1},{-4,-3,-2,1},{-4,-3,-1,2},
    {-4,-3,1,2},{-4,-2,-1,3},{-4,-1,2,3},{-4,1,2,3},{-3,-2,-1,4},{-3,-2,1,4},
    {-3,1,2,4},{-2,-1,3,4},{-2,1,3,4},{-1,2,3,4}}]),
  assert(f([2,1,0]) = [{1,2,3,4}, {{-4,-3,-2,-1},{-4,-3,-2,1},{-4,-3,-1,2},
    {-4,-3,1,2},{-4,-2,-1,3},{-4,-1,2,3},{-4,1,2,3},{-3,-2,-1,4},{-3,-2,1,4},
    {-3,-1,2,4},{-2,-1,3,4},{-2,1,3,4},{1,2,3,4}}]),
  assert(f([1,0,2]) = [{1,2,3,4}, {{-4,-3,-2,-1},{-4,-3,-2,1},{-4,-3,-1,2},
    {-4,-3,1,2},{-4,-2,-1,3},{-4,-2,1,3},{-4,-1,2,3},{-3,-2,-1,4},{-3,-2,1,4},
    {-3,1,2,4},{-2,-1,3,4},{-1,2,3,4},{1,2,3,4}}]),
  if oklib_test_level = 0 then return(true),
  for i : 2 thru 4 do 
    for j in permutations(create_list(k,k,1,i)) do block([permDNF : f(j)],
      assert(length(clauses_f(permDNF)) = 2^length(permDNF[1]) - i)
    ),
  true)$

okltest_perm_cnfp(f) := block(
  assert(f([{},{{}}], [], dll_simplest_trivial1)),
  assert(not f([{},{{}}], [1], dll_simplest_trivial1)),
  assert(not f([{},{}], [1], dll_simplest_trivial1)),
  assert(not f([{},{}], [1,2,3], dll_simplest_trivial1)),
  assert(f([{1,2,3,4},{{-4,-3,-2,-1},{-4,-3,-1,2},{-4,-3,1,2},
    {-4,-2,1,3},{-4,-1,2,3},{-4,1,2,3},{-3,-2,-1,4},
    {-3,-2,1,4},{-3,1,2,4},{-2,-1,3,4},{-2,1,3,4},
    {-1,2,3,4},{1,2,3,4}}], [3,2,1], dll_simplest_trivial1)),
  true)$

/*!
\endhtmlonly
*/