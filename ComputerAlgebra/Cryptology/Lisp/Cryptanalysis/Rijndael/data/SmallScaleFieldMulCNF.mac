/* Matthew Gwynne, 16.12.2010 (Swansea) */
/* Copyright 2010, 2011 Oliver Kullmann
This file is part of the OKlibrary. OKlibrary is free software$ you can redistribute
it and/or modify it under the terms of the GNU General Public License as published by
the Free Software Foundation and included in this library$ either version 3 of the
License, or any later version. */

/*!
  \file ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/SmallScaleFieldMulCNF.mac
  \brief CNF and r_1-based CNF representations with smallest number of clauses known for each small scale field multiplication

Use by

oklib_load("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/SmallScaleFieldMulCNF.mac")$

*/

/*!
\htmlonly
*/

oklib_include("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/FieldOperationsAnalysis.mac")$
oklib_include("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/FieldMul2CNF.mac")$


/*********************************************************
 * Smallest known number of clauses                      *
 *********************************************************
*/

/* Generated using

   $OKlib/Experimentation/Investigations/Cryptography/AdvancedEncryptionStandard/minimise_cnf_cryptominisat

   applied to output_ssmult_fullcnf_stdname(e,2,4,ss_polynomial_2_4) for each
   e in {2,...,15}. */

/* Takes the exponent and the element in the field to multiply with */
ss_field_cnfs : sm2hm({})$

set_hm(ss_field_cnfs, [4,2],
  [[1,2,3,4,5,6,7,8],[{-5,2},{-2,5},{-6,3},{-3,6},{-7,-4,-1},{-1,4,7},{-8,1},
  {-7,4,8},{-4,7,8}]])$
set_hm(ss_field_cnfs, [4,3],
  [[1,2,3,4,5,6,7,8],[{-5,1,2},{-1,2,5},{-6,-3,-2},{-6,-5,-1,3},{-6,1,3,5},
  {-2,3,6},{-5,-3,-1,6},{-3,1,5,6},{-8,-4,-1},{-8,1,4},{-8,-7,-3},{-8,3,7},
  {-4,1,8},{-1,4,8},{-7,3,8},{-3,7,8}]])$
set_hm(ss_field_cnfs, [4,4],
  [[1,2,3,4,5,6,7,8],[{-5,3},{-3,5},{-6,-4,-1},{-6,1,4},{-4,1,6},{-1,4,6},
  {-7,-2,-1},{-2,1,7},{-8,2},{-7,1,8},{-1,7,8}]])$
set_hm(ss_field_cnfs, [4,5],
  [[1,2,3,4,5,6,7,8],[{5,-3,-1},{-5,1,3},{-6,-4,-1,2},{-6,-2,-1,4},{-4,1,2,6},
  {-2,1,4,6},{-7,-3,-2,1},{-7,-2,-1,3},{-7,2,5},{-3,1,2,7},{-1,2,3,7},
  {-2,5,7},{-8,-4,-2},{-8,2,4},{-6,1,8},{-1,6,8}]])$
set_hm(ss_field_cnfs, [4,6],
  [[1,2,3,4,5,6,7,8],[{-5,2,3},{-3,2,5},{-6,-4,-1,3},{-3,1,4,6},{-7,3,4,5},
  {-7,-5,-1,6},{-5,-4,-3,7},{-6,1,5,7},{-8,-2,-1},{-8,-6,-5,4},{-8,-7,-4,1},
  {-8,3,6,7},{-2,1,8},{-4,5,6,8},{-7,-6,-3,8},{-1,4,7,8}]])$
set_hm(ss_field_cnfs, [4,7],
  [[1,2,3,4,5,6,7,8],[{-5,-3,-1,2},{-2,1,3,5},{-7,2,3,4},{-7,-4,-1,5},
  {-7,1,6},{-4,-3,-2,7},{-5,1,4,7},{-1,6,7},{-8,-2,-1,4},{-8,-5,-4,3},
  {-8,-6,-3},{-8,2,5,7},{-4,1,2,8},{-3,4,5,8},{-6,3,8},{-7,-5,-2,8}]])$
set_hm(ss_field_cnfs, [4,8],
  [[1,2,3,4,5,6,7,8],[{-5,-4,-1},{-1,4,5},{-6,1,2},{-6,-5,-2,4},{-6,-4,-2,5},
  {-2,1,6},{-5,2,4,6},{-4,2,5,6},{-7,-3,-2},{-3,2,7},{-8,3},
  {-7,2,8},{-2,7,8}]])$
set_hm(ss_field_cnfs, [4,9],
  [[1,2,3,4,5,6,7,8],[{-4,5},{-6,1},{-1,6},{-7,2},{-2,7},{-8,3,4},{-8,-5,-3},
  {-3,4,8},{-5,3,8}]])$
set_hm(ss_field_cnfs, [4,10],
  [[1,2,3,4,5,6,7,8],[{-6,-3,-2,1},{-6,-2,-1,3},{-3,1,2,6},{-1,2,3,6},
  {-7,-5,-3},{-7,3,5},{-7,-6,-4},{-7,4,6},{-5,3,7},{-3,5,7},{-6,4,7},{-4,6,7},
  {-8,-3,-1},{-8,1,3},{-6,2,8},{-2,6,8}]])$
set_hm(ss_field_cnfs, [4,11],
  [[1,2,3,4,5,6,7,8],[{-4,2,5},{-2,4,5},{-6,-3,-1},{-6,1,3},{-3,1,6},{-1,3,6},
  {-7,-4,-2,1},{-7,1,2,4},{-7,-5,-1},{-4,-2,-1,7},{-1,2,4,7},{-5,1,7},
  {-8,-6,-4},{-8,4,6},{-6,4,8},{-4,6,8}]])$
set_hm(ss_field_cnfs, [4,12],
  [[1,2,3,4,5,6,7,8],[{-5,-3,-1,4},{-5,1,3,4},{-4,-3,-1,5},{-4,1,3,5},
  {-6,-4,-2},{-6,2,4},{-4,2,6},{-2,4,6},{-7,-5,-4},{-7,4,5},{-3,1,7},{-1,3,7},
  {-8,-3,-2},{-8,2,3},{-3,2,8},{-2,3,8}]])$
set_hm(ss_field_cnfs, [4,13],
  [[1,2,3,4,5,6,7,8],[{-5,3,4},{-3,4,5},{-6,-5,-3},{-6,3,5},{-4,6},{-7,1},
  {-1,7},{-8,-5,-2},{-8,2,5},{-5,2,8},{-2,5,8}]])$
set_hm(ss_field_cnfs, [4,14],
  [[1,2,3,4,5,6,7,8],[{-5,1,6},{-1,5,6},{-7,-4,-3},{-7,3,4},{-7,-5,-1,2},
  {-7,1,2,5},{-7,-6,-2},{-4,3,7},{-3,4,7},{-5,-2,-1,7},{-2,1,5,7},{-6,2,7},
  {-8,-5,-4},{-8,4,5},{-5,4,8},{-4,5,8}]])$
set_hm(ss_field_cnfs, [4,15],
  [[1,2,3,4,5,6,7,8],[{-6,3,4},{-6,-5,-2},{-3,4,6},{-5,2,6},{-7,-6,-3},
  {-7,3,6},{-4,7},{-8,1,5},{-8,-6,-1,2},{-8,-2,-1,6},{-1,5,8},{-6,1,2,8},
  {-2,1,6,8}]])$
set_hm(ss_field_cnfs, [8,2], FieldMul2CNF)$
set_hm(ss_field_cnfs, [8,3], FieldMul3CNF)$
set_hm(ss_field_cnfs, [8,9], FieldMul9CNF)$
set_hm(ss_field_cnfs, [8,11], FieldMul11CNF)$
set_hm(ss_field_cnfs, [8,13], FieldMul13CNF)$
set_hm(ss_field_cnfs, [8,14], FieldMul14CNF)$
/* ... */


/*********************************************************
 * r_1-bases with smallest known number of clauses       *
 *********************************************************
*/

ss_field_rbase_cnfs : sm2hm({})$

/* For each field element small scale exponent e and field element a, the
   following CNFs have been generated by the following commands:

maxima> e : 4$ a : 2$
maxima> output_ssmult_fullcnf_stdname(a,2,e,ss_polynomial(2,e));
shell>  e=4; a=2
shell>  QuineMcCluskey-n8-O3-DNDEBUG ss_byte2_${e}_field_mul_full_${a}.cnf > primes_${e}_${a}.cnf
shell>  cat primes_${e}_${a}.cnf | SortByClauseLength-O3-DNDEBUG > primes_${e}_${a}_sorted.cnf
shell>  RUcpGen-O3-DNDEBUG primes_${e}_${a}_sorted.cnf | RUcpBase-O3-DNDEBUG > mul_${e}_${a}_base.cnf

These are the smallest known r_1 bases, but it is not known if they are the
the minimum size.

*/
set_hm(ss_field_rbase_cnfs, [4,2], [[1,2,3,4,5,6,7,8],
  [{-5,2},{-2,5},{-6,3},{-3,6},{-8,1},{-1,8},{-7,-4,-1},{-7,1,4},{-4,1,7},
  {-1,4,7}]])$
set_hm(ss_field_rbase_cnfs, [4,3], [[1,2,3,4,5,6,7,8],
  [{-5,-2,-1},{-5,1,2},{-2,1,5},{-1,2,5},{-6,-3,-2},{-6,2,3},{-3,2,6},
   {-2,3,6},{-8,-4,-1},{-8,1,4},{-8,-7,-3},{-8,3,7},{-4,1,8},{-1,4,8},
   {-7,3,8},{-3,7,8},{-7,-6,-5,4},{-7,-6,-4,5},{-7,-5,-4,6},{-7,4,5,6},
   {-6,-5,-4,7},{-6,4,5,7},{-5,4,6,7},{-4,5,6,7}]])$
set_hm(ss_field_rbase_cnfs, [4,4], [[1,2,3,4,5,6,7,8],
  [{-5,3},{-3,5},{-8,2},{-2,8},{-6,-4,-1},{-6,1,4},{-4,1,6},{-1,4,6},
   {-7,-2,-1},{-7,1,2},{-2,1,7},{-1,2,7}]])$
set_hm(ss_field_rbase_cnfs, [4,5], [[1,2,3,4,5,6,7,8],
  [{-5,-3,-1},{-5,1,3},{-3,1,5},{-1,3,5},{-7,-5,-2},{-7,2,5},{-5,2,7},
   {-2,5,7},{-8,-4,-2},{-8,2,4},{-8,-6,-1},{-8,1,6},{-4,2,8},{-2,4,8},
   {-6,1,8},{-1,6,8},{-7,-6,-4,3},{-7,-6,-3,4},{-7,-4,-3,6},{-7,3,4,6},
   {-6,-4,-3,7},{-6,3,4,7},{-4,3,6,7},{-3,4,6,7}]])$
set_hm(ss_field_rbase_cnfs, [4,6], [[1,2,3,4,5,6,7,8],
  [{-5,-3,-2},{-5,2,3},{-3,2,5},{-2,3,5},{-7,-4,-2},{-7,2,4},{-4,2,7},
   {-2,4,7},{-8,-2,-1},{-8,1,2},{-2,1,8},{-1,2,8},{-6,-4,-3,1},{-6,-4,-1,3},
   {-6,-3,-1,4},{-6,1,3,4},{-4,-3,-1,6},{-4,1,3,6},{-3,1,4,6},{-1,3,4,6},
   {-7,-6,-5,1},{-7,-6,-1,5},{-7,-5,-1,6},{-7,1,5,6},{-6,-5,-1,7},{-6,1,5,7},
   {-5,1,6,7},{-1,5,6,7},{-8,-6,-5,4},{-8,-6,-4,5},{-8,-5,-4,6},{-8,4,5,6},
   {-8,-7,-6,3},{-8,-7,-3,6},{-8,-6,-3,7},{-8,3,6,7},{-6,-5,-4,8},{-6,4,5,8},
   {-5,4,6,8},{-4,5,6,8},{-7,-6,-3,8},{-7,3,6,8},{-6,3,7,8},{-3,6,7,8}]])$
set_hm(ss_field_rbase_cnfs, [4,7], [[1,2,3,4,5,6,7,8],
  [{-6,-5,-4},{-6,4,5},{-5,4,6},{-4,5,6},{-7,-6,-1},{-7,1,6},{-6,1,7},
   {-1,6,7},{-8,-6,-3},{-8,3,6},{-6,3,8},{-3,6,8},{-5,-3,-2,1},{-5,-3,-1,2},
   {-5,-2,-1,3},{-5,1,2,3},{-3,-2,-1,5},{-3,1,2,5},{-2,1,3,5},{-1,2,3,5},
   {-7,-4,-3,2},{-7,-4,-2,3},{-7,-3,-2,4},{-7,2,3,4},{-4,-3,-2,7},{-4,2,3,7},
   {-3,2,4,7},{-2,3,4,7},{-8,-4,-2,1},{-8,-4,-1,2},{-8,-2,-1,4},{-8,1,2,4},
   {-8,-7,-5,2},{-8,-7,-2,5},{-8,-5,-2,7},{-8,2,5,7},{-4,-2,-1,8},{-4,1,2,8},
   {-2,1,4,8},{-1,2,4,8},{-7,-5,-2,8},{-7,2,5,8},{-5,2,7,8},{-2,5,7,8}]])$
set_hm(ss_field_rbase_cnfs, [4,8], [[1,2,3,4,5,6,7,8],
  [{-8,3},{-3,8},{-5,-4,-1},{-5,1,4},{-4,1,5},{-1,4,5},{-6,-2,-1},{-6,1,2},
  {-2,1,6},{-1,2,6},{-7,-3,-2},{-7,2,3},{-3,2,7},{-2,3,7}]])$
set_hm(ss_field_rbase_cnfs, [4,9], [[1,2,3,4,5,6,7,8],
  [{-5,4},{-4,5},{-6,1},{-1,6},{-7,2},{-2,7},{-8,-4,-3},{-8,3,4},{-4,3,8},
   {-3,4,8}]])$
set_hm(ss_field_rbase_cnfs, [4,10], [[1,2,3,4,5,6,7,8],
  [{-7,-5,-3},{-7,3,5},{-7,-6,-4},{-7,4,6},{-5,3,7},{-3,5,7},{-6,4,7},
   {-4,6,7},{-8,-3,-1},{-8,1,3},{-8,-6,-2},{-8,2,6},{-3,1,8},{-1,3,8},
   {-6,2,8},{-2,6,8},{-5,-4,-2,1},{-5,-4,-1,2},{-5,-2,-1,4},{-5,1,2,4},
   {-4,-2,-1,5},{-4,1,2,5},{-2,1,4,5},{-1,2,4,5}]])$
set_hm(ss_field_rbase_cnfs, [4,11], [[1,2,3,4,5,6,7,8],
  [{-5,-4,-2},{-5,2,4},{-4,2,5},{-2,4,5},{-6,-3,-1},{-6,1,3},{-3,1,6},
   {-1,3,6},{-7,-5,-1},{-7,1,5},{-5,1,7},{-1,5,7},{-8,-6,-4},{-8,4,6},
   {-6,4,8},{-4,6,8},{-8,-7,-3,2},{-8,-7,-2,3},{-8,-3,-2,7},{-8,2,3,7},
   {-7,-3,-2,8},{-7,2,3,8},{-3,2,7,8},{-2,3,7,8}]])$
set_hm(ss_field_rbase_cnfs, [4,12], [[1,2,3,4,5,6,7,8],
  [{-6,-4,-2},{-6,2,4},{-4,2,6},{-2,4,6},{-7,-3,-1},{-7,1,3},{-7,-5,-4},
   {-7,4,5},{-3,1,7},{-1,3,7},{-5,4,7},{-4,5,7},{-8,-3,-2},{-8,2,3},{-3,2,8},
   {-2,3,8},{-8,-6,-5,1},{-8,-6,-1,5},{-8,-5,-1,6},{-8,1,5,6},{-6,-5,-1,8},
   {-6,1,5,8},{-5,1,6,8},{-1,5,6,8}]])$
set_hm(ss_field_rbase_cnfs, [4,13], [[1,2,3,4,5,6,7,8],
  [{-6,4},{-4,6},{-7,1},{-1,7},{-5,-4,-3},{-5,3,4},{-4,3,5},{-3,4,5},
   {-8,-5,-2},{-8,2,5},{-5,2,8},{-2,5,8}]])$
set_hm(ss_field_rbase_cnfs, [4,14], [[1,2,3,4,5,6,7,8],
  [{-6,-5,-1},{-6,1,5},{-5,1,6},{-1,5,6},{-7,-4,-3},{-7,3,4},{-7,-6,-2},
   {-7,2,6},{-4,3,7},{-3,4,7},{-6,2,7},{-2,6,7},{-8,-5,-4},{-8,4,5},{-5,4,8},
   {-4,5,8},{-8,-3,-2,1},{-8,-3,-1,2},{-8,-2,-1,3},{-8,1,2,3},{-3,-2,-1,8},
   {-3,1,2,8},{-2,1,3,8},{-1,2,3,8}]])$
set_hm(ss_field_rbase_cnfs, [4,15], [[1,2,3,4,5,6,7,8],
  [{-7,4},{-4,7},{-6,-4,-3},{-6,3,4},{-6,-5,-2},{-6,2,5},{-4,3,6},{-3,4,6},
  {-5,2,6},{-2,5,6},{-8,-5,-1},{-8,1,5},{-5,1,8},{-1,5,8}]])$
set_hm(ss_field_rbase_cnfs, [8,2],
  [[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],
  [{-9,2},{-2,9},{-10,3},{-3,10},{-11,4},{-4,11},{-14,7},{-7,14},{-16,1},
  {-1,16},{-12,-5,-1},{-12,1,5},{-5,1,12},{-1,5,12},{-13,-6,-1},{-13,1,6},
  {-6,1,13},{-1,6,13},{-15,-8,-1},{-15,1,8},{-8,1,15},{-1,8,15}]])$
set_hm(ss_field_rbase_cnfs, [8,3], [[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],
  [{-9,-2,-1},{-9,1,2},{-2,1,9},{-1,2,9},{-10,-3,-2},{-10,2,3},{-3,2,10},
  {-2,3,10},{-11,-4,-3},{-11,3,4},{-4,3,11},{-3,4,11},{-14,-7,-6},{-14,6,7},
  {-7,6,14},{-6,7,14},{-16,-8,-1},{-16,1,8},{-16,-15,-7},{-16,7,15},{-8,1,16},
  {-1,8,16},{-15,7,16},{-7,15,16},{-12,-5,-4,1},{-12,-5,-1,4},{-12,-4,-1,5},
  {-12,1,4,5},{-5,-4,-1,12},{-5,1,4,12},{-4,1,5,12},{-1,4,5,12},{-13,-6,-5,1},
  {-13,-6,-1,5},{-13,-5,-1,6},{-13,1,5,6},{-13,-12,-6,4},{-13,-12,-4,6},
  {-13,-6,-4,12},{-13,4,6,12},{-6,-5,-1,13},{-6,1,5,13},{-5,1,6,13},
  {-1,5,6,13},{-12,-6,-4,13},{-12,4,6,13},{-6,4,12,13},{-4,6,12,13},
  {-12,-11,-10,-9,-5},{-12,-11,-10,5,9},{-12,-11,-9,5,10},{-12,-11,-5,9,10},
  {-12,-10,-9,5,11},{-12,-10,-5,9,11},{-12,-9,-5,10,11},{-12,5,9,10,11},
  {-11,-10,-9,5,12},{-11,-10,-5,9,12},{-11,-9,-5,10,12},{-11,5,9,10,12},
  {-10,-9,-5,11,12},{-10,5,9,11,12},{-9,5,10,11,12},{-5,9,10,11,12},
  {-15,-14,-13,-8,-5},{-15,-14,-13,5,8},{-15,-14,-8,5,13},{-15,-14,-5,8,13},
  {-15,-13,-8,5,14},{-15,-13,-5,8,14},{-15,-8,-5,13,14},{-15,5,8,13,14},
  {-14,-13,-8,5,15},{-14,-13,-5,8,15},{-14,-8,-5,13,15},{-14,5,8,13,15},
  {-13,-8,-5,14,15},{-13,5,8,14,15},{-8,5,13,14,15},{-5,8,13,14,15}]])$



/*!
\endhtmlonly
*/
